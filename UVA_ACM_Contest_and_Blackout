#include <iostream>
#include <queue>
#include <vector>
#define mp make_pair
#define MAX 105
using namespace std;

const int INF = 1e7;
vector<pair<int, int> > graph[MAX];
int checkin[MAX][MAX][3 * MAX];
int path[MAX];
int dist[MAX];
bool visited[MAX];
int cnt[MAX];//degree check
int N, M;

struct edge {
	edge(int s, int t, int c) : s(s), t(t), c(c) {}
	int s;
	int t;
	int c;
};

void resetGraph() {
	for (int i = 1; i <= N; i++) {
		graph[i].clear();
		cnt[i] = 0;
	}
	for (int i = 1; i < MAX; i++)
		for (int j = 1; j < MAX; j++) 
			for (int z = 1; z < 3 * MAX; z++) {
				checkin[i][j][z] = false;
			}

}

int MST(int s) {
	for (int i = 1; i <= N; i++) {
		path[i] = -1;
		dist[i] = INF;
		visited[i] = false;
	}
	priority_queue<pair<int, int>, vector<pair<int, int> >, greater<pair<int, int> > > pq;
	pq.push(mp(0, s));
	dist[s] = 0;
	while (!pq.empty()) {
		int u = pq.top().second;
		pq.pop();
		visited[u] = true;
		for (pair<int, int>& neighbor : graph[u]) {
			int v = neighbor.second;
			int w = neighbor.first;
			if (!visited[v] && !checkin[u][v][w] && w < dist[v]) {
				dist[v] = w;
				pq.push(mp(dist[v], v));
				path[v] = u;
			}
		}
	}
	int sum = 0;
	for (int i = 1; i <= N; i++) {
		sum += dist[i];
		if (sum >= INF) return -1;
	}
	return sum;
}

vector<edge> traceback() {
	vector<edge> tmp;
	tmp.clear();
	for (int i = 1; i <= N; i++) {
		int u = path[i];
		if (u != -1) {
			tmp.push_back(edge(u, i, dist[i]));
		}
	}
	return tmp;
}

int main() {
	ios_base::sync_with_stdio(false);
	cin.tie(0);
	int T, a, b, c; 
	cin >> T;
	while (T--) {
		cin >> N >> M;
		int min1 = INF, min2 = INF;
		resetGraph();

		for (int i = 1; i <= M; i++) {
			cin >> a >> b >> c;
			cnt[a]++; cnt[b]++;
			graph[a].push_back(mp(c, b));
			graph[b].push_back(mp(c, a));
		}

		min1 = MST(1);

		vector<edge> firstMSTEdges = traceback();
		for (int i = 0; i < firstMSTEdges.size(); i++) {
			int u = firstMSTEdges[i].s;
			int v = firstMSTEdges[i].t;
			int w = firstMSTEdges[i].c;

			cnt[u]--; cnt[v]--;
			checkin[u][v][w] = checkin[v][u][w] = true;

			int x;
			for (x = 1; x <= N; x++) {
				if (cnt[x] > 0) break;
			}
			int K = MST(x);
			if (K >= 0)	min2 = min(min2, MST(x));
			checkin[u][v][w] = checkin[v][u][w] = false;
			cnt[u]++; cnt[v]++;
		}
		if (min2 >= INF) min2 = min1;
		cout << min1 << " " << min2 << endl;
	}
	return 0;
}
